<!DOCTYPE html>
<meta charset="utf-8">
<title>animas</title>
<head >

  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
    div#fps,svg { position: fixed; top:0; left:0; color: white; }
  </style>
	
</head>
<body style="cursor:crosshair"></body>

<!--  d3   -->
<!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
<!-- <script src="https://d3js.org/d3-geo.v1.min.js"></script> -->
<!-- <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script> -->
<!-- <script src="https:////unpkg.com/d3-force-3d@1.0/build/d3-force-3d.bundle.min.js"></script> -->
<!--  topojson   -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.0/topojson.min.js"></script> -->
<!--  three   -->
<!-- <script src="https:////cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js"></script> -->
<!-- <script src="https:////unpkg.com/three-trackballcontrols-web@0.0.2/dist/three-trackballcontrols.min.js"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.5/dat.gui.min.js"></script> -->
<!-- <script src="https://unpkg.com/d3-force-magnetic@0.6.1/dist/d3-force-magnetic.min.js"></script> -->


<div id="viewframe" class="viewframe"></div>
<script src="ents.js"></script>

<script>

// file:///E:/e/c/d3air%20-%20Copy/zindex272-fractals3.html


/*******************************************
 * 			@PLUGIN
 *
 */	
	var muonAlima = function muonAlima(__mapper) {

		let props = __mapper('xs').m('props')	// props
		let f = props.lib																// function
		let local = {}																	// local
		
		__mapper({"xs": xs.xs(__mapper)})								// PROXIES
		
		// __mapper({"renderCanvas": renderCanvas.renderCanvas(__mapper)})	// CANVAS
		
		__mapper({"renderSVG": renderSVG.renderSVG(__mapper)})						// SVG
		__mapper("xs").c("versor").control(__mapper("renderSVG").svg()) // SVG VERSOR	
		// __mapper("xs").c("pos")(__mapper("renderSVG").svg())		// SVG POSITION
		__mapper("xs").m("image")("zimg-black.jpg")				// BCK IMAGE
		
		__mapper({"renderWebgl": renderWebgl.renderWebgl(__mapper)})				// WEBGL
		
		__mapper({'bosonAnimation': bosonAnimation.bosonAnimation(__mapper)})	// ANIMATION
		__mapper({'muonStore': muonStore.muonStore(__mapper)})				// STORE
		
		__mapper("xs").c("key").start()									// KEYBRD CONTROLS	
		
/*******************************************
 * 		@controls
 * 
 */					
	// .............................................. gui
		// gui = new dat.GUI()
		// gui.add(window, "restart")
		
	// .............................................. RightArrowAlt
	let controltimerRightArrowAlt = () => {

		if (__mapper("bosonAnimation").animationStop !== undefined)
			{
			console.log("started",__mapper("controlTimer").started())
			if (__mapper("controlTimer").started()) {
					__mapper("controlTimer").stop()
			} else {
					console.log("controlTimer resume")
					__mapper("controlTimer").resume()
			}	
		}
	}
	__mapper("controlKey").subscribe(controltimerRightArrowAlt, "rightArrowAlt")
	
	
	let mouseDownListener = function mouseDownListener(event) {
		
		__mapper("xs").m("mouse").mouseDown(1)
		__mapper("xs").m("mouse").mouseDownShared(1)
		__mapper("xs").m("mouse").event(event)

	}		

	let mouseUpListener = function mouseUpListener(event) {

		__mapper("xs").m("mouse").mouseDown(0)
		__mapper("xs").m("mouse").mouseDownShared(0)
		
	}
	__mapper("xs").c("key").start()									// MOUSE
	
	if (__mapper("renderSVG")) __mapper("xs").c("mouseDown").control(__mapper("renderSVG").svg()).subscribe(mouseDownListener, __mapper("renderSVG").svg())
	if (__mapper("renderSVG")) __mapper("xs").c("mouseUp").control(__mapper("renderSVG").svg()).subscribe(mouseUpListener, __mapper("renderSVG").svg())	
	
/*******************************************
 * 		@FPS
 * 
 */				
// const fpsdiv = d3.select('body').append('div').attr('id','fps') 
// __mapper("xs").m("fps").init()	

/*******************************************
 * 		@STATS
 * 
 */				
var stats = __mapper("xs").m("stats")() // new Stats();
stats.showPanel( -1 ); // 0: fps, 1: ms, 2: mb, 3+: custom
document.body.appendChild( stats.dom );
function animate() {
	stats.begin();	/* monitored code goes here */; stats.end()
	requestAnimationFrame( animate )
}
requestAnimationFrame( animate )


/*******************************************
 * 		@props
 * 
 */				
let tim = {"td":36800,"t0":0,"t1":1000,"t2":1,"t3":1,}

/*******************************************
 * 		@animas
 * 
 */					
// ------------------------------- 	mark1000000_1		
let mark1000000_1 = {					// motion support form
			"pic": {
				"tim": tim,
				"ric": {"gid":"nat","cid":"nat","fid":"nat",},
				"halo":"nat",
				
				"form": {
			
					"x": {
						"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
						"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, 		// circle
						"ra2": 90,
						"v0": 0,"v1":1,
						"w4":  [[[0, 1 * 360]]], //  [[[60, 60 + 1 * 360]]], // 
						"seg5": 360,"pa6":0,"pb7":-1,
						"fas8": 0,
					},
					"y": {
						"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
						"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, 		// circle
						"ra2": 90,
						"v0":0,"v1":1,
						"w4":  [[[0, 1 * 360]]], //  [[[60, 60 + 1 * 360]]], // 
						"seg5": 360,"pa6":0,"pb7":-1,
						"fas8": -90, 		// fas8, antifase
					},
					"z": {
						"m1":6,"m2":6,"n1":[[[100,200]]],"n2":[[[100,2]]],"n3":[[[100,200]]],"a":1,"b":1, // square
						"ra2": [[[260/  Math.sqrt(2),260/  Math.sqrt(2)]]],
						"v0": 0,"v1":1,
						"w4":  0, // [[[180,360,180]]], // [[[0,-360,0]]],
						"seg5": 12,"pa6":0,"pb7":-1,
						"fas8": 0,
					}
					
				},
				"state": {
							"x": [[[300,300]]],
							"y": [[[200, 200]]],
							"z": 0,
				},
				"ture": { "csx":0,"cf":[[[444,555,444]]],"cs":888,"cw":0.5,"co":[[[0.3,0.3,0.3]]],"cp":[[[0.3,0.3,0.3]]],},
				
				"projection": {
					"projection": "identity",
					"scale": 1,
					"translate": [ 0, 0 ],
					"rotate": [ 0, 0, 0 ],
					},
				
			},
	}		
	let nums0010000 = {
			"pic": {
				"tim": tim,
				"ric": {"gid":"numform","cid":"numform","fid":"numform"},
				"halo":"numform",

				"ture": {"csx":0,"cf":666,"cs":[[[999,999,999]]],"cw":1,"co":0.01,"cp":[[[0.7,0.7]]]},
				"numform": {
					"pos":[[[ [0,0] ]] , 	[[ [360,360] ]]],
					"fas":  [[[180,180 + 360]]],
					"step":360,
					"size":[[[2,2]]],
					"div":1,
					"mod":13,
					"z":0, 
					"dist":[[[12,12,12]]],									
				},
			},
	}
	
let msg0100000 = {
			"pic": {
				"tim": tim,
				"ric": {"gid":"msgg","cid":"msgc","fid":"msgf",},
				"halo": "tracemsg",

				"state": {
							"x": [[[300,300]]],
							"y": [[[200, 200]]],
							"z": 0,
				},
				"ture": { "csx":0,"cf":[[[500,666]]],"co":[[[0.9,0.9]]],"cs":[[[111,666]]],"cw":[[[0.3,0.9]]],"cp":[[[0.7,0.9]]],},
				
				"projection": {
					"projection": "identity",
					"scale": 1,
					"translate": [ 0, 0 ],
					"rotate": [ 0, 0, 0 ],
					},
				"msg": {
					"txt":"anima",
					"size":12,
					"pos":[[[ [0,0] ]] , 	[[ [360,360] ]]],
					"fas":  [[[180,180 + 360]]],
					"step":12,
					"div":1,
					"mod":13,
					"z":0, 
					"dist":[[[12,12,12]]],						
				},
				
			},
	}
	
let traces0000001 = {
			"pic": {
				"tim": tim,
				"ric": {"gid":"tline","cid":"tline","fid":"tline",},
				"halo": "traceline",

				"form": 	{
						
							"x": {
								"m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,	// circle
								"ra2": 6,
								"v0": 0,"v1":1,
								"w4": [[[90 , 90 + 2 * 360]]], //  [[[60, 60 + 1 * 360]]], // 
								"seg5": 360,"pa6":0,"pb7":-1,
								"fas8": 0,
							},
							"y": {
								"m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,	// circle
								"ra2": 6,
								"v0":0,"v1":1,
								"w4": [[[90 , 90 + 2  * 360]]], //  [[[60, 60 + 1 * 360]]], // 
								"seg5": 360,"pa6":0,"pb7":-1,
								"fas8": 90, 		// fas8, antifase
							},
							"z": {
								"m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,	// circle
								"ra2": [[[260/  Math.sqrt(2),260/  Math.sqrt(2)]]],
								"v0": 0,"v1":1,
								"w4":  0, // [[[180,360,180]]], // [[[0,-360,0]]],
								"seg5": 12,"pa6":0,"pb7":-1,
								"fas8": 0,
							}
							
						},
				"ture": { "csx":0,"cf":[[[500,666]]],"co":[[[0.009,0.009]]],"cs":[[[444,666]]],"cw":[[[0.9,0.9]]],"cp":[[[0.7,0.9]]],},
				
				"state": {
					
						"pos": 10,
						// "x": {
								// "pos": 0,
								// "step":120,
								// "dist":0,
						// },
						// "y": {
								// "pos": 0,
								// "step":120,
								// "dist":0,
						// },
						
				},
				"projection": {
					"projection": "identity",
					"scale": 1,
					"translate": [ 0, 0 ],
					"rotate": [ 0, 0, 0 ],
				},
				
			},
	}

// ------------------------------- 	mark0100000_2		
let mark0100000_2 = {
			"pic": {
				"tim": tim,
				"ric": {"gid":"mark","cid":"mark","fid":"mark_2",},
				"halo":"nat",
				"form": {
			
						"x": {
								"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
								"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, 		// circle
								"ra2": 40,
								"v0": 0,"v1":1,
								"w4":  [[[0,  (1 + 4) * 360]]], //  [[[60, 60 + 1 * 360]]], // 
								"seg5": 360,"pa6":0,"pb7":-1,
								"fas8": 0,
						},
						"y": {
								"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
								"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, 		// circle
								"ra2": 40,
								"v0":0,"v1":1,
								"w4": [[[0,  (1 + 4) * 360]]], //  [[[60, 60 + 1 * 360]]], // 
								"seg5": 360,"pa6":0,"pb7":-1,
								"fas8": -90, 		// fas8, antifase
						},
						"z": {
								"m1":6,"m2":6,"n1":[[[100,200]]],"n2":[[[100,2]]],"n3":[[[100,200]]],"a":1,"b":1, // square
								"ra2": [[[260/  Math.sqrt(2),260/  Math.sqrt(2)]]],
								"v0": 0,"v1":1,
								"w4":  0, // [[[180,360,180]]], // [[[0,-360,0]]],
								"seg5": 12,"pa6":0,"pb7":-1,
								"fas8": 0,
						}
					
				},
				"state": {
						"x": {
								"pos": [[[ [0,0] ]] , 	[[ [359, 359] ]]],
								"step":359,
								"ang":  [[[ [0,0] ]] , 	[[ [-359, -359] ]]],
						},
						"y": {
								"pos": [[[ [0,0] ]] , 	[[ [359, 359] ]]],
								"step":359,
								"ang":  [[[ [0,0] ]] , 	[[ [-359, -359] ]]],
						},
				},
				"ture": { "csx":0,"cf":[[[222,333,222]]],"cs":888,"cw":0.5,"co":[[[0.3,0.3,0.3]]],"cp":[[[0.3,0.3,0.3]]],},
				
				"projection": {
					"projection": "identity",
					"scale": 1,
					"translate": [ 0, 0 ],
					"rotate": [ 0, 0, 0 ],
					},
				
			},
	}			
// ------------------------------- 	mark0010000_3		
let mark0010000_3 = {
			"pic": {
				"tim": tim,
				"ric": {"gid":"mark","cid":"mark","fid":"mark_3",},
				"halo":"nat",
				"form": {
			
					"x": {
						"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
						"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, // circle
						"ra2": 18,
						"v0": 0,"v1":1,
						"w4":  [[[0, (1 +  12) * 360]]],  //  [[[60, 60 + 1 * 360]]], // 
						"seg5": 360,"pa6":0,"pb7":-1,
						"fas8": 0,
					},
					"y": {
						"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
						"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, // circle
						"ra2": 18,
						"v0":0,"v1":1,
						"w4":  [[[0, (1 +  12) * 360]]], //  [[[60, 60 + 1 * 360]]], // 
						"seg5": 360,"pa6":0,"pb7":-1,
						"fas8": -90, 		// fas8, antifase
					},
					"z": {
						"m1":6,"m2":6,"n1":[[[100,200]]],"n2":[[[100,2]]],"n3":[[[100,200]]],"a":1,"b":1, // square
						"ra2": [[[260/  Math.sqrt(2),260/  Math.sqrt(2)]]],
						"v0": 0,"v1":1,
						"w4":  0, // [[[180,360,180]]], // [[[0,-360,0]]],
						"seg5": 12,"pa6":0,"pb7":-1,
						"fas8": 0,
					}
					
				},
				"state": {
						"x": {
								"pos": [[[ [0,0] ]] , 	[[ [359, 359] ]]],
								"step":359,
						},
						"y": {
								"pos": [[[ [0,0] ]] , 	[[ [359, 359] ]]],
								"step":359,
						},
				},
				"ture": { "csx":0,"cf":[[[222,333,222]]],"cs":888,"cw":0.5,"co":[[[0.3,0.3,0.3]]],"cp":[[[0.3,0.3,0.3]]],},
				
				"projection": {
					"projection": "identity",
					"scale": 1,
					"translate": [ 0, 0 ],
					"rotate": [ 0, 0, 0 ],
					},
				
			},
	}	
	// ------------------------------- 	mark0001000_4		
let mark0001000_4 = {
			"pic": {
				"tim": tim,
				"ric": {"gid":"mark","cid":"mark","fid":"mark_4",},
				"halo":"nat",
				"form": {
			
					"x": {
						"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
						"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, // circle
						"ra2": 4,
						"v0": 0,"v1":1,
						"w4":  [[[0, 1 * 360]]], //  [[[60, 60 + 1 * 360]]], // 
						"seg5": 360,"pa6":0,"pb7":-1,
						"fas8": 0,
					},
					"y": {
						"m1":5,"m2":5,"n1":2,"n2":7,"n3":7,"a":1,"b":1,	// star
						"m1":[[[4,4]]],"m2":[[[4,4]]],"n1":2,"n2":2,"n3":2,"a":1,"b":1, // circle
						"ra2": 4,
						"v0":0,"v1":1,
						"w4":  [[[0, 1 * 360]]], //  [[[60, 60 + 1 * 360]]], // 
						"seg5": 360,"pa6":0,"pb7":-1,
						"fas8": -90, 		// fas8, antifase
					},
					"z": {
						"m1":6,"m2":6,"n1":[[[100,200]]],"n2":[[[100,2]]],"n3":[[[100,200]]],"a":1,"b":1, // square
						"ra2": [[[260/  Math.sqrt(2),260/  Math.sqrt(2)]]],
						"v0": 0,"v1":1,
						"w4":  0, // [[[180,360,180]]], // [[[0,-360,0]]],
						"seg5": 12,"pa6":0,"pb7":-1,
						"fas8": 0,
					}
					
				},
				"state": {
						"x": {
								"pos": [[[0,  32 * 360]]],
								"step":359,
								"ref": 0,
						},
						"y": {
								"pos": [[[0, 32 * 360]]],
								"step":359,
								"ref": 0,
						},
				},
				"ture": { "csx":0,"cf":[[[222,333,222]]],"cs":888,"cw":0.5,"co":[[[0.3,0.3,0.3]]],"cp":[[[0.3,0.3,0.3]]],},
				
				"projection": {
					"projection": "identity",
					"scale": 1,
					"translate": [ 0, 0 ],
					"rotate": [ 0, 0, 0 ],
					},
				
			},
	}
/*******************************************
 * @animaApi
 * 
 */

		mark0001000_4.avatars = {
			traces0000001,			// traceline
			// nums0010000,				// numform
			// msg0100000, 				// msg
		}
		mark0010000_3.avatars = {
			mark0001000_4,			// nat
		}
		mark0100000_2.avatars = {
			mark0010000_3,			// nat
		}
		mark1000000_1.avatars = {
			mark0100000_2,			// nat
		}
		let animas = [
			mark1000000_1,			// nat
		] 

		var animaApi = function animaApi() {

				__mapper("xs").m("store").apply({"type":"UPDANIMA","caller":"alima","animas":animas})
			
		}
	
	return animaApi

}

var __mapper = muonMapper.muonMapper()
var muonAlima = __mapper({'muonAlima': muonAlima(__mapper)}).muonAlima(__mapper)
</script>
<body style="cursor:crosshair"></body>
