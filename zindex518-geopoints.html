<!DOCTYPE html>
<meta charset="utf-8">
<title>animas</title>
<head >

  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
    div#fps,svg { position: fixed; top:0; left:0; color: white; }
  </style>

</head>
<body style="cursor:crosshair"></body>
<div id="viewframe" class="viewframe"></div>

<script src="enls.js"></script>
<script src="ents.js"></script>

<script>

let muonAlima = function muonAlima(__mapper) {

  __mapper({"xs": xs.xs(__mapper)})               // PROXIES
  __mapper("xs").b("init")({svg:1,versor:1,webgl:1,img:0})  // INIT

  let f = __mapper({"props": muonProps.muonProps()}).props()
  let snap = __mapper("xs").b("snap")

 /*******************************************
 *      @pics
 */
  let tim = {"td":3800,"t0":0,"t1":1000,"t2":1,"t3":1,}
  let boform = { csx:0, cf:777, cs:222, cw:1.7, co:0.7, cp:0.5,}
  let geoform = {type:"Feature", geometry:{ type: "Point", coordinates:[0,0]}, properties:{pointRadius:6,}}
  
  let translate = {"m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,}
  let proform = {projection: "uniwen", scale: 1, translate: [ 0, 100 ], rotate: [ 0, 0, 0 ], dims: 2,}
         
 /*******************************************
 *    @animas
 */
  let p1 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p1",},
    stace: [ [[[ 100, 125 ]]], 100, 0 ],
  }
  let p2 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p2",},
    stace: [[[ () => [ [[[150,175]]] , 100, 0] ]]],
  }
  let p3 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p3",},
    stace: [ [[[ t => (() => 175 )()  ]]] , 100, ],
  }
  let p4 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p4",},
    stace: [ [[[ 200, 225 ]]], 100, 0 ],
  }
  let p5 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p5",},
    stace: {x: [[[250,275]]], y: 100 },
  }
  let p6 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p6",},
    stace: [[[ () => {
      let geo = {"type": "LineString","coordinates": [ [300,100,0], [325,100,0], [300,100,0], ]}
      return f.ta(f.unslide(geo.coordinates))   // dimensional triple array 
    } ]]],
  }
  let p7 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p7",},
    stace: [[[ {
       "x": {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       },
       "y": {
         "m1":4,"m2":4,"n1":100,"n2":100,"n3":100,"a":1,"b":1,  // square
         "ra2": 100,"v0":0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": -90,
       },
     } ]]],
  }
  let p8 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p8",},
    stace: [ [[[ {
             "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
             "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
           } ]]],
           [[[ {
             "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
             "ra2": 100,"v0":0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
           } ]]] 
         ],
  }
  let p9 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p9",},
    stace: {
       "x": [[[ {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       } ]]],
       "y": [[[ {
         "m1":4,"m2":4,"n1":100,"n2":100,"n3":100,"a":1,"b":1,  // square
         "ra2": 100,"v0":0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       } ]]],
     },
  }
  let p10 = {           // NOK
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p10",},
    proform: proform,
    stace: [
      
       [[[ (t, a = 378, b = {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       }  ) => {
          let as = a
          let bs = __mapper("xs").b("snap")( b, t, 1 ).x
          return as + bs
       } ]]] ,
       
       [[[ (t, a = 100, b = {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       }  ) => {
          let as = a
          let bs = __mapper("xs").b("snap")( b, t, 1 ).y
          return as + bs
       } ]]] ,
       
     ],
  }
  let p11 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p11",},
    stace: [[[ {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       } ]]],
  }
  let p12 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p12",},
    stace: [[[ (...args) => {
        let a = [[[ {
           "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
           "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
        } ]]]
        if (args.length === 0) {
            return a 
        } else {
            let as = args[0]
            return  [ 100 + as.x, 100 + as.y ]
        }
    } ]]]
  }
   let p13 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p13",},
    proform: {projection: "uniwen", scale: 1, rotate: [ 0, 0, 0 ], dims: 2, 
      translate: [
      
       [[[ t => {
          let snap = __mapper("xs").b("snap")
          let fn = (a,b) => a + b.x
          let args = [
            378, 
            [[[ {
             "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
             "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
            } ]]]
          ]
          args = args.map(d => snap(d,t,0))
          return fn(...args)
       } ]]],
       
       [[[ (t, a = 100, b = {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       }  ) => {
          let snap = __mapper("xs").b("snap")
          let as = a
          let bs = snap( b, t, 1 ).y
          return as + bs
       } ]]] ,
       
     ],
    },
  }
   let p14 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p14",},
    proform: {projection: "uniwen", scale: 1, rotate: [ 0, 0, 0 ], dims: 2, 
      translate: 
      
       [[[ t => {
          let snap = __mapper("xs").b("snap")
          let fn = (a,b) => [ a[0] + b.x, a[1] + b.y , a[2] + b.z ]
          let args = [
            [378, 124, 0], 
            [[[ {
             "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
             "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
            } ]]]
          ]
          args = args.map(d => snap(d,t,0))
          return fn(...args)
       } ]]],
       

    },
  } 
  let p15 = {
    tim: tim, halo: "geojson", boform: boform, geoform: geoform, ric: {"gid":"p","cid":"p","fid":"p15",},
    // proform: {projection: "uniwen", scale: 1, rotate: [ 0, 0, 0 ], dims: 2, 
      // translate: [[[ {
         // "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         // "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       // } ]]],
    // },       
			stace: [[[ {
         "m1":4,"m2":4,"n1":2,"n2":2,"n3":2,"a":1,"b":1,        // circle
         "ra2": 100,"v0": 0,"v1":1,"w4": 90,"seg5": 360,"pa6":0,"pb7":-1,"fas8": 0,
       } ]]],

  }
	
	
  // -------------------------------  img
  let img = {

    "tim": tim,
    "ric": {"gid":"img","cid":"img","fid":"img",},
    "halo":"img",
    "boform": { "csx":0,"cf":[[[22,22]]],"cs":22,"cw":[[[0.7,0.7]]],"co":[[[0.7,0.7,]]],"cp":[[[0.5,0.5]]],},

    "geoform": p => ({
      type:  "Feature",
      geometry: {

        "type": "Point",
        "coordinates": [0, 0]

      },
      properties: {
        attr: {
          "width": p.payload.img.width,
          "height": p.payload.img.height,
          ["xlink:href"]: p.payload.img.url,
        }
      }
    }),

    "stace": {
      "x": [[[15, 15]]],
      "y": [[[20, 20]]],
    },

    "payload": {

      "img": {
        "url":"zimg-501.jpg",
        "width": [[[60, 60]]],
        "height": [[[40 , 40]]],
      },


    }
  }
	
  let animas = [
    p1,  // h.geojson g.uniwen
    // p2,  // h.geojson g.uniwen
    // p4,  // h.geojson g.uniwen
    // p5,  // h.geojson g.uniwen
    // p6,  // h.geojson g.uniwen
    // p7,  // h.geojson g.uniwen
    // p8,  // h.geojson g.uniwen
    // p9,  // h.geojson g.uniwen
    // p10,  // h.geojson g.uniwen
    // p11,  // h.geojson g.uniwen
    // p12,  // h.geojson g.uniwen nok
    // p13,  // h.geojson g.uniwen nok
    // p14,  // h.geojson g.uniwen nok
    // p15,  // h.geojson g.uniwen nok
    // img,      // h.img		
  ]

  return () => __mapper("xs").m("store").apply({"type":"UPDANIMA","caller":"alima","animas":animas})

}

let __mapper = bosonMapper.bosonMapper()
__mapper({"muonAlima": muonAlima(__mapper)}).muonAlima(__mapper)
</script>
<body style="cursor:crosshair"></body>
