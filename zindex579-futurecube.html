<!DOCTYPE html>
<meta charset="utf-8">
<title>animas</title>
<head >

  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
    div#fps,svg { position: fixed; top:0; left:0; color: white; }
  </style>

</head>
<body style="cursor:crosshair"></body>
<div id="viewframe" class="viewframe"></div>

<script src='https://d3js.org/d3.v4.min.js'></script>
<script src='https://d3js.org/d3-geo.v1.min.js'></script>
<script src='https://d3js.org/d3-geo-projection.v2.min.js'></script>
<script src='https:////unpkg.com/d3-force-3d@1.0.7/build/d3-force-3d.bundle.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.0/topojson.min.js'></script>
<script src='https:////cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js'></script>
<script src='https:////unpkg.com/three-trackballcontrols-web@0.0.2/dist/three-trackballcontrols.min.js'></script>
<script src="enls.js"></script>
<script src="ents.js"></script>

<script>

  let muonAlima = function muonAlima(__mapper) {

    __mapper({"xs": xs.xs(__mapper)})               // PROXIES
    __mapper("xs").b("init")({svg:1,versor:1,wen:1,webgl:1,pos:0})  // INIT

    let f = __mapper({'props': bosonProps.bosonProps()}).props()

  /**********************
   *    @
   */
  let width = __mapper("renderRenderer").width()
  let height = __mapper("renderRenderer").height()

  let g = __mapper("xs").m("geom")
  let w = __mapper("xs").m("wen")

/*******************************************
 *      @pics
 */
let tim = {"td":19800,"t0":0,"t1":1000,"t2":1,"t3":1,}

let proformCube = {
      "projections": ["uniwen","unidentity","identity","universor","unimercator"],
      "projectidx": 0,
      "translate":  [ [[[320,320]]] , 200],
      "scale": 60,
      "rotate": [-5,50,0],
      "focale": 4,
      "zafin": [ [[[0,0,1,1,1,0]]] ,[[[0,0,1,1,1,0]]] ],  // [0,1], // [1,0]
      "dims": 3,
      "control": "wen",
  }

let graticule = {

      "extent": [ [-180, 180, [[[30,45,30,45,30]]], [[[30,45,30,45,30]]]],  [-90, 90, [[[12,6,12,6,12]]], [[[12,6,12,6,12]]]] ],

    }

let proformFuture = {

      "projection": "futuri",
        "scale": 30,
        "translate": [ 250, 200, 0 ],
        "rotate": [28,-4,0],
        "trees":  [
                [-1, 0, 1, 5, 0, 2],
              ],
        "treeidx":  [[[0,0,0]]],
        "faciaRotation": Math.PI / 1,
        "control":  "versor",

    }

let geograt = {

        "tim": tim,
        "ric": {"gid":"geograt","cid":"geograt","fid":"geograt",},

         "geoform": (p) => {

            return {
                type: "MultiLineString",
                coordinates: __mapper("xs").m("graticule").grarrx(p.graticule)
            }

          },

        "halo":"geojson",

        "boform": { "csx":0,"cf":[[[111,111]]],"cs":666,"cw":0.3,"co":[[[0.05,0.05]]],"cp":[[[0.9,0.9]]],},
        "graticule": graticule,
        "proform": proformFuture,

    }

let geoearth = {

        "tim": tim,
        "ric": {"gid":"geoearth","cid":"geoearth","fid":"geoearth",},
        "halo":"geojson",

        "boform":{ "csx":0,
          "cf":[[[555,333,555,333,555,333,555]]],
          "cs":333,"cw":0.2,"co":0.4,"cp":0.9,},

        "proform": proformFuture,

        "geoform": [[[ () => {
            let geo = Object.assign({},
              topojson.feature(
                __mapper("xs").d("worldTopo110m").data(),
                __mapper("xs").d("worldTopo110m").data().objects.land
              )
            )
            geo = __mapper("xs").m("geoj").trim(geo)

            return geo
          } ]]],

    }

let geosphere = {

        "tim": tim,
        "ric": {"gid":"geosphere","cid":"geosphere","fid":"geosphere",},
        "halo":"geojson",

        "boform":{ "csx":0,"cf":444,"cs":333,"cw":0.9,"co":0.04,"cp":0.9,},

        "proform": proformFuture,

        "geoform": [[[ () => {
            let geo = {"type": "Sphere"}
            return geo
          } ]]],

    }
// ------------------------- img
  let img = {

    "tim": tim,
    "ric": {"gid":"img","cid":"img","fid":"img",},
    "halo":"img",

    "boform": { "csx":0,"cf":[[[22,22]]],"cs":22,"cw":[[[0.7,0.7]]],"co":[[[0.7,0.7,]]],"cp":[[[0.5,0.5]]],},

    "geoform": p => ({
      type:  "Feature",
      geometry: {

        "type": "Point",
        "coordinates": [0, 0]

      },
      properties: {
        attr: {
          "width": p.payload.img.width,
          "height": p.payload.img.height,
          ["xlink:href"]: p.payload.img.url,
        }
      }
    }),

    "stace": {
      "x": [[[15, 15]]],
      "y": [[[20, 20]]],
    },

    "payload": {

      "img": {
        "url":"zimg-501.jpg",
        "width": [[[60, 60]]],
        "height": [[[40 , 40]]],
      },

    }
  }

  let animas = [
      img,          // h.img
      geograt,      // h.geojson g.futuri
      geoearth,     // h.geojson g.futuri
      geosphere,    // h.geojson  g.futuri
  ]

  return () => __mapper("xs").m("store").apply({"type":"UPDANIMA","caller":"alima","animas":animas})

}

let __mapper = bosonMapper.bosonMapper()
__mapper({"muonAlima": muonAlima(__mapper)}).muonAlima(__mapper)
</script>
<body style="cursor:crosshair"></body>