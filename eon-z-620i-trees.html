<script src="eon-x-eonify.js"></script>
<script>
window.xEonify.eon({anitem, time: undefined})

// .................. anitem
async function anitem (__eo) {
  // .................. eons
  let [
    ctlWen,
    eohalMars,
    eohalSol,
    muonProps,
    muonSoma,
    renderSvg,
  ] = await Promise.all([
    __eo('xs').c('wen'),
    __eo('xs').e('mars'),
    __eo('xs').e('sol'),
    __eo('xs').m('props'),
    __eo('xs').m('soma'),
    __eo('xs').r('svg'),
  ])

  let muonStore = __eo('muonStore')

  // .................. animas
  let ani = function () {
    let p0 = {
      eocrom: {csx: 3, cf: 555, cs: 111, cw: 6.9, co: 0.0072, cp: 0.99},
      x0: -40, y0: -100,

      growthDir: [[[1 * Math.PI / 2, 1 * Math.PI / 2 ]]],

      depth: [[[0, 9]]], // [[[0, 12]]], // depth iter

      growunit: 2, // rate of feature growth in tick
      maxSpreadAngle: 1 * Math.PI / 2, // max abs ang delta
      mitoDirections: [ -1.1, 0.1, 0.9 ], // [ -1.1, 0.9 ], // deviations

      shrinkage: 0.7, // 0.9, // size shrink
      colordelta: 160, // 100, // color delta between gens

      subgrow: 1, // inside growth
      subgrowunit: 0.3, // rate of feature growth in tick
      subSpreadAngle: Math.PI / 6, // width of secondary deviation
      subMitoDirs: [0.1], // direction in stems
      subShrinkage: 0.9, // size shrink
      subgrowrate: (i, q) => 8 * (q - Math.abs(i - (q / 2))) / q,

    }

    let p = {
      eocrom: {csx: 2, cf: 555, cs: 111, cw: 6.9, co: 0.0072, cp: [[[0.09, 0.09, 0.09, 0.99]]]},
      x0: 0, y0: -160,
      growthDir: Math.PI / 2,

      depth: [[[0, 12]]], // [[[0, 12]]], // depth iter

      growunit: 2, // rate of feature growth in tick
      maxSpreadAngle: 1 * Math.PI / 2, // max abs ang delta
      mitoDirections: [ -1.1, 0.9 ], // [ -1.1, 0.9 ], // deviations

      shrinkage: 0.8, // 0.9, // size shrink
      colordelta: 100, // 100, // color delta between gens

      subgrow: 1, // inside growth
      subgrowunit: 2, // rate of feature growth in tick
      subSpreadAngle: -Math.PI / 12, // width of secondary deviation
      subMitoDirs: [0.1], // direction in stems
      subShrinkage: 0.9, // size shrink
      subgrowrate: (i, q) => 1,
    }

    // .................. animas
    let q = 6
    let animas = []
    for (let i = 0; i < q; i++) {
      let pi = muonProps.clone(p)
      animas[i] = muonSoma.soma(i, pi)
    }

    return animas
  }

  let enty = () => {}
  enty.ani = ani
  return enty
}
</script>
